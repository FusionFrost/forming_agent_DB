//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "openzip.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma link "ZipForge"
#pragma resource "*.dfm"
TfrmMain *frmMain;
//---------------------------------------------------------------------------
__fastcall TfrmMain::TfrmMain(TComponent* Owner)
    : TForm(Owner)
{
	arv = new Archiv;
}
void TfrmMain::call()
{
STARTUPINFO StartInfo = {sizeof(TStartupInfo)};
PROCESS_INFORMATION ProcInfo;
LPCSTR t;
StartInfo.cb= sizeof(StartInfo);
StartInfo.dwFlags = STARTF_USESHOWWINDOW;
StartInfo.wShowWindow= SW_HIDE;

char buffer[1000];
GetCurrentDirectory(sizeof(buffer),buffer);
AnsiString curDir = buffer;

		AnsiString CmdLine= curDir + "\\7z\\7za.exe x " + curDir +"\\7z\\*.7z -r -o" + curDir + "\\7z\\";
		if(!CreateProcess(NULL, CmdLine.c_str(),
				NULL,NULL,false,
				CREATE_NEW_CONSOLE|HIGH_PRIORITY_CLASS,
				NULL,NULL, &StartInfo, &ProcInfo))
		ShowMessage("Ошибка");
        else
		{
        if (WaitForSingleObject(ProcInfo.hProcess,1000)== WAIT_TIMEOUT)
        CloseHandle(ProcInfo.hProcess);
        }

}
void __fastcall TfrmMain::Button1Click(TObject *Sender)
{
    String dir;
	SelectDirectory("Выбор каталога","", dir );
}


//---------------------------------------------------------------------------

